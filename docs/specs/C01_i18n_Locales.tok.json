{
  "id": "C01",
  "fn": "docs/specs/C01_i18n_Locales.tok.json",
  "t": "i18n, Locales & Routing Strategy",
  "v": "0.1.0",
  "st": "draft",
  "own": [
    "product",
    "eng",
    "ux"
  ],
  "src": {
    "md": "docs/specs/C01_i18n_Locales.md"
  },
  "rel": [
    {
      "doc": "A00",
      "why": "Locale segment and route patterns are defined by the App Router tree."
    },
    {
      "doc": "B01",
      "why": "lib/i18n/config.ts is the implementation anchor for locale configuration."
    },
    {
      "doc": "A02",
      "why": "Locale switcher UI belongs in global layout/header."
    },
    {
      "doc": "D01",
      "why": "CMS localization strategy must align with WP queries and content model."
    }
  ],
  "body": {
    "as_is": {
      "locale_seg": "[locale]",
      "routes_ref": {
        "doc": "A00",
        "sec": "route_patterns"
      },
      "config_file": "lib/i18n/config.ts"
    },
    "locales": {
      "default": "en [Decision]",
      "supported": [
        "en",
        "es"
      ]
    },
    "routing": {
      "canonical_pattern": "/{locale}/...",
      "invalid_locale": "404",
      "default_locale_prefix": "always_prefix [Decision Z02-20251215-02]"
    },
    "translations": {
      "source_of_truth": "code_dicts (microcopy) + cms (content)",
      "loading": "server_load (next-intl)",
      "fallback_locale": "en",
      "missing_key_behavior": "fallback_to_default"
    },
    "cms_localization": {
      "collections_ref": {
        "doc": "A00",
        "sec": "collections"
      },
      "strategy": "1:1 mapping (polylang/wpml) [Decision Z02-20251215-06]",
      "slug_policy": "per_locale"
    },
    "ui": {
      "locale_switcher": {
        "location": "components/layout/Header.tsx",
        "behavior": "preserve_path_if_possible",
        "missing_translation_behavior": "hide_option | show_warning"
      }
    },
    "req": [
      {
        "id": "C01-FR-001",
        "txt": "Define supported locales and default locale in lib/i18n/config.ts.",
        "pri": "P0"
      },
      {
        "id": "C01-FR-002",
        "txt": "Validate locale segment for every locale route.",
        "pri": "P0"
      },
      {
        "id": "C01-FR-003",
        "txt": "URL locale is authoritative; persist or derive locale consistently.",
        "pri": "P1"
      },
      {
        "id": "C01-NFR-001",
        "txt": "Translation loading must be performant; caching strategy defined.",
        "pri": "P1"
      }
    ],
    "open": []
  }
}